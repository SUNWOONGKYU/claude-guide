# 7편 | Claude Code 서브 에이전트 이해

---

서브 에이전트(Sub Agent)는 Claude Code의 가장 혁신적인 기능 중 하나입니다. 마치 회사에서 업무별로 전문가를 두는 것처럼, 코드 리뷰 전문가, 테스트 작성 전문가, 보안 검토 전문가 등을 각각 만들어서 활용할 수 있습니다.

## 1. 서브 에이전트란 무엇인가?

### 기본 개념 이해

Claude Code 서브 에이전트는 **특정 작업에 특화된 AI 전문가**입니다. 기존 Claude Code가 "만능 개발자 1명"이었다면, 서브 에이전트는 "각자 전문 분야가 있는 개발팀 여러 명"을 갖는 것과 같습니다.

예를 들어, 하나의 프로젝트에 코드 리뷰 전문가, 테스트 작성 전문가, 보안 검토 전문가를 각각 배치하여 동시에 여러 작업을 처리할 수 있습니다. 각 서브 에이전트는 자신의 전문 영역에만 집중하므로 더 빠르고 정확한 결과를 제공합니다.

### 핵심 특징

**독립적 컨텍스트**: 각 서브 에이전트는 자신만의 대화 공간을 가집니다. A 에이전트가 처리한 내용이 B 에이전트의 작업에 영향을 주지 않아 더 정확한 결과를 얻을 수 있습니다. 이는 메인 대화의 컨텍스트를 소비하지 않아 긴 세션에서도 중요한 맥락을 유지할 수 있게 해줍니다.

**맞춤형 역할**: 서브 에이전트마다 구체적인 역할과 성격을 부여할 수 있습니다. "보수적이고 꼼꼼한 보안 검토자", "창의적이고 사용자 친화적인 UI 디자이너" 등으로 설정 가능합니다.

**도구 권한 제어**: 필요한 도구만 접근할 수 있게 제한하여 안전성을 높이고 집중도를 향상시킵니다. 보안 검토 에이전트는 파일 읽기와 분석 도구만, 배포 에이전트는 서버 접속과 배포 도구만 사용하도록 제한할 수 있습니다.

**병렬 실행 가능**: 일부 개발자 커뮤니티의 테스트 결과에 의하면 10개의 서브 에이전트가 동시에 작업이 가능하다고 합니다. 대규모 프로젝트에서 여러 작업을 병렬로 처리하여 시간을 크게 단축할 수 있습니다.

### 일반 Claude와의 차이점

서브 에이전트와 일반 Claude는 여러 면에서 근본적인 차이가 있습니다.

**컨텍스트 관리 방식**: 일반 Claude는 하나의 대화 세션에서 모든 내용을 공유하는 반면, 서브 에이전트는 각자 독립된 컨텍스트를 가져 자신의 전문 분야에만 집중할 수 있습니다.

**역할과 전문성**: 일반 Claude는 범용적인 역할을 수행하며 모든 종류의 작업을 처리하려 합니다. 반면 서브 에이전트는 특정 작업에 특화되어 있어, 보안 검토 에이전트는 오직 보안 취약점만 검사하고, 테스트 생성 에이전트는 테스트 케이스 작성에만 집중합니다.

**도구 접근 권한**: 일반 Claude는 모든 도구에 접근 가능하지만, 서브 에이전트는 필요한 도구만 선택적으로 사용합니다.

**실행 방식의 차이**: 일반 Claude는 순차적으로 작업을 처리합니다. 하나의 작업이 끝나야 다음 작업을 시작할 수 있습니다. 서브 에이전트는 최대 10개까지 병렬로 실행 가능하여, 여러 작업을 동시에 처리함으로써 전체 작업 시간을 단축시킬 수 있습니다.

## 2. 왜 서브 에이전트가 필요한가?

### 기존 개발 환경의 문제점

**컨텍스트 오염 문제**: 하나의 Claude 세션에서 코딩, 디버깅, 문서 작성, 테스트 등을 모두 처리하다 보면 대화가 길어지고 복잡해집니다. AI가 이전 맥락을 혼동하여 부정확한 답변을 할 확률이 높아집니다.

**역할 혼재로 인한 비효율**: 코드 리뷰를 요청했는데 AI가 동시에 새로운 기능을 제안하거나, 버그 수정을 요청했는데 전체 구조 개선까지 제안하는 등 집중도가 떨어지는 경우가 빈번했습니다.

**반복 작업의 비효율성**: 매번 같은 형태의 설명이나 지시를 반복해야 하는 불편함이 있었습니다. 예를 들어, 코드 리뷰를 할 때마다 "보안, 성능, 가독성을 중점적으로 봐주세요"라는 설명을 반복해야 했습니다.

### 서브 에이전트가 제공하는 해결책

**전문화와 집중도 향상**: 각 서브 에이전트가 특정 역할에만 집중하므로 해당 분야에서 더 전문적이고 정확한 결과를 제공합니다. 코드 리뷰 전담 에이전트는 오직 코드 품질과 보안만 검토하고, 테스트 작성 에이전트는 테스트 케이스 생성에만 집중합니다.

**병렬 처리를 통한 생산성 극대화**: 여러 서브 에이전트가 동시에 다른 작업을 수행할 수 있습니다. 한 서브 에이전트가 코드를 리뷰하는 동안, 다른 서브 에이전트는 문서를 작성하고, 또 다른 서브 에이전트는 테스트를 생성할 수 있습니다.

**일관성 있는 품질 관리**: 각 서브 에이전트가 명확한 기준과 방법론을 가지고 있어 작업 결과의 일관성이 크게 향상됩니다. 사람의 주관이나 컨디션에 좌우되지 않고 일정한 기준으로 수행됩니다.

### 현업에서의 실제 변화

안트로픽 내부 보안팀의 경우, 코드 취약점 진단 및 패치 속도가 3배 향상되었다고 합니다. 자동화된 병렬 분석 덕분에 복잡한 다중 버그도 실시간으로 수정하고 검증할 수 있습니다. 마케팅팀에서는 수백 개의 캠페인을 여러 전문 서브 에이전트의 협업으로 1일 만에 완료한 사례가 보고되었습니다.


## 3. 서브 에이전트의 구조와 작동 원리

### 3대 핵심 구성 요소

서브 에이전트는 단순한 도구가 아니라 "전문가 팀"입니다. 각자의 전문 분야에서 최고의 성과를 내는 AI 팀을 구성하여, 개발 속도와 품질을 동시에 향상시킬 수 있습니다. 이를 가능하게 하는 3가지 핵심 구성 요소를 살펴보겠습니다.

**시스템 프롬프트(System Prompt)**: 서브 에이전트의 성격, 역할, 작업 방식을 정의하는 지시문입니다. 마치 직원에게 주는 업무 매뉴얼과 같습니다.

```
당신은 시니어 보안 전문가입니다. 코드를 검토할 때 다음 사항에 집중하세요:
- SQL 인젝션 취약점
- XSS 공격 가능성
- 인증/인가 로직 점검
- 민감 정보 노출 위험
검토 결과는 심각도별로 구분하여 구체적인 수정 방안과 함께 제시해주세요.
```

**컨텍스트 윈도우(Context Window)**: 해당 서브 에이전트만의 독립적인 대화 공간입니다. 다른 서브 에이전트나 Claude Code 메인 에이전트와 분리되어 있어 맥락 혼동 없이 집중된 작업이 가능합니다.

**도구 권한(Tool Permissions)**: 각 서브 에이전트가 사용할 수 있는 도구를 제한적으로 설정합니다. 코드 리뷰 서브 에이전트는 파일 읽기와 분석 도구만, 배포 서브 에이전트는 서버 접속과 배포 도구만 사용하도록 제한할 수 있습니다.

### 작동 메커니즘

**자동 호출**: Claude Code가 사용자 요청을 분석하여 적절한 서브 에이전트를 자동 선택합니다.

**수동 호출**: 사용자가 `@에이전트이름`을 사용하여 특정 서브 에이전트를 직접 호출할 수 있습니다. 예: `@code-reviewer 이 코드를 검토해줘`

**병렬 실행**: 대규모 프로젝트에서 여러 작업을 병렬로 처리하여 시간을 크게 단축할 수 있습니다.

### 오케스트레이션 시스템

Claude Code 메인 에이전트는 "프로젝트 매니저" 역할을 하며, 각 서브 에이전트의 작업 결과를 조합하여 최종 응답을 만듭니다.

**순차적 협업**: A 서브 에이전트 → B 서브 에이전트 → C 서브 에이전트 순서로 작업을 이어받아 진행
**병렬 협업**: 여러 서브 에이전트가 동시에 다른 작업을 수행한 후 결과를 통합
**검증 협업**: 한 서브 에이전트가 작업하고 다른 서브 에이전트가 검증하는 이중 체크 시스템

중요한 점은 **서브 에이전트끼리 직접 대화는 불가능**하지만, 한 서브 에이전트의 결과를 다른 서브 에이전트가 입력으로 받을 수 있다는 것입니다. 이를 통해 체이닝 패턴으로 복잡한 워크플로우를 구성할 수 있습니다.

## 4. 주요 서브 에이전트 종류

### 개발 및 아키텍처 전문 서브 에이전트

**code-reviewer (코드 검토자)**
- 역할: 코드 품질, 보안, 성능, 가독성 검토
- 활용 시기: PR 제출 전, 중요한 기능 개발 후

**backend-architect (백엔드 설계자)**
- 역할: RESTful API 설계, 마이크로서비스 아키텍처, DB 스키마 설계
- 활용 시기: 새로운 API 개발, 시스템 확장 시

**frontend-developer (프론트엔드 개발자)**
- 역할: React 컴포넌트 구축, 반응형 레이아웃, 상태 관리
- 활용 시기: UI 컴포넌트 개발, 사용자 인터페이스 개선 시

**api-designer (API 설계자)**
- 역할: REST API, GraphQL 스키마 설계 및 검증
- 활용 시기: 새로운 서비스 설계, API 버전 업그레이드 시

**database-expert (데이터베이스 전문가)**
- 역할: 스키마 설계, 쿼리 최적화, 마이그레이션 전략
- 활용 시기: 데이터 구조 설계, 성능 문제 해결 시

### 품질 관리 및 디버깅 전문 서브 에이전트

**test-automator (테스트 자동화 전문가)**
- 역할: 단위 테스트, 통합 테스트, E2E 테스트 자동 생성
- 활용 시기: 새로운 기능 개발 후, 리팩토링 전후

**test-generator (테스트 생성자)**
- 역할: 테스트 케이스 자동 생성, 엣지 케이스 탐지
- 활용 시기: 함수나 클래스 작성 후 즉시 테스트 생성

**security-auditor (보안 감사 전문가)**
- 역할: 보안 취약점 탐지, OWASP Top 10 검사
- 활용 시기: 배포 전 보안 검토, 정기 보안 점검

**performance-optimizer (성능 최적화 전문가)**
- 역할: 병목 지점 분석, 메모리 최적화, 실행 속도 개선
- 활용 시기: 서비스 속도 저하 시, 대용량 데이터 처리

**debugger (디버거)**
- 역할: 오류 진단, 스택 트레이스 해석, 문제 원인 추적
- 활용 시기: 버그 발생 시, 예기치 않은 동작 발생 시

**bug-hunter (버그 탐지 전문가)**
- 역할: 잠재적 버그 탐지, 오류 패턴 분석, 자동 수정
- 활용 시기: 코드 건전성 체크, 배포 전 최종 점검

### 운영 및 문서화 전문 서브 에이전트

**devops-specialist (데브옵스 전문가)**
- 역할: CI/CD 파이프라인 구축, 배포 자동화, 인프라 관리
- 활용 시기: 배포 환경 구축, 운영 자동화

**documentation-writer (문서화 전문가)**
- 역할: API 문서, 사용자 가이드, 기술 문서 자동 생성
- 활용 시기: 새 기능 개발 완료 후, API 변경 시

## 6. 커뮤니티 서브 에이전트 활용

다른 개발자들이 만들어서 공유한 서브 에이전트를 활용하여 즉시 생산성을 향상시킬 수 있습니다. 마치 스마트폰 앱스토어에서 앱을 다운받아 쓰는 것처럼, 검증된 서브 에이전트를 가져와서 바로 사용할 수 있습니다.

**인기 서브 에이전트 TOP 5**:

1. **code-reviewer** - 코드 문제점 자동 검토
2. **test-generator** - 테스트 코드 자동 생성
3. **api-designer** - RESTful API 설계
4. **debugger** - 오류 진단 및 해결
5. **performance-optimizer** - 성능 병목 개선

**커뮤니티 서브 에이전트 적용 방법**:

**Step 1**: GitHub에서 "claude code subagent"로 검색  
**Step 2**: `.md` 파일 다운로드  
**Step 3**: 프로젝트에 맞게 커스터마이징  
**Step 4**: 저장 위치 선택
- 프로젝트용: `.claude/agents/`
- 개인용: `%USERPROFILE%\.claude\agents\` (Windows)

**Step 5**: 저장 즉시 사용 가능

## 7. 서브 에이전트 디렉토리 관리

### 디렉토리 구조와 우선순위

```
📁 프로젝트/
├── 📁 .claude/
│   └── 📁 agents/              ← 프로젝트 전용 서브 에이전트
│       ├── 📄 security-auditor.md
│       ├── 📄 team-reviewer.md
│       └── 📄 api-tester.md
└── 📄 기타 프로젝트 파일들...

📁 사용자 홈 (%USERPROFILE%)/
└── 📁 .claude/
    └── 📁 agents/              ← 모든 프로젝트 공통 서브 에이전트
        ├── 📄 code-optimizer.md
        ├── 📄 bug-hunter.md
        └── 📄 doc-writer.md
```

| 구분 | 프로젝트 레벨 | 사용자 레벨 |
|------|---------------|-------------|
| **위치** | `.claude/agents/` | `~/.claude/agents/` |
| **범위** | 해당 프로젝트만 | 모든 프로젝트 |
| **우선순위** | 높음 | 낮음 |

### 디렉토리에서 할 수 있는 일

**1. 목록 조회**:
- 어떤 서브 에이전트들이 있는지 한눈에 확인
- 프로젝트 vs 사용자 레벨 구분 표시
- 중복 이름 시 우선순위 표시

**2. 상태 확인**:
- 서브 에이전트가 제대로 설정되어 있는지 확인
- 오류가 있는 서브 에이전트 표시 (빨간색 ❌)
- 정상 동작하는 서브 에이전트 표시 (초록색 ✅)

**3. 빠른 접근**:
- 서브 에이전트 파일을 바로 열어서 수정
- 불필요한 서브 에이전트 즉시 삭제
- 새 서브 에이전트 생성 바로 시작

---

**작성일: 2025년 9월 3일 / 글자수: 5,070자 / 작성자: Claude / 프롬프터: 써니**
